<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HASH STATE</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-size: 3vh;
    }

    #root {
      display: flex;
      flex-direction: column;
      width: 100vw;
      height: 100vh;
    }

    #head {
      width: 100vw;height: 10vh;background-color: blue;display: flex;flex-direction: row;text-align: center;justify-content: center;align-items: center;
    }

    #board {
      width: 100vw;height: 90vh;background-color: white;display: flex;flex-direction: row; justify-content: center;align-items: center;
    }

    #home {
      width: 25vw;
      cursor: pointer;
      margin: auto;
    }

    #team {
      width: 25vw;
      cursor: pointer;
    }

    #member {
      width: 25vw;
      cursor: pointer;
    }

    #purpose {
      width: 25vw;
      cursor: pointer;
    }

    form {
          background-color: yellowgreen;
          width: 80vw;
          padding: 20px;
          border-radius: 8px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
          margin: 20px auto; 
        }

        input, textarea {
          padding: 10px;
          box-sizing: border-box;
          border: 1px solid #ccc;
          border-radius: 4px;
        }

        input {
          width: 5vw;
          height: 5vh;
          margin-right: 2px; 
          vertical-align: top;
        }

        textarea {
          width: 60vw;
          height: 5vh;
          vertical-align: top;
        }

        button {
          background-color: #4caf50;
          color: #fff;
          width: 5vw;
          height: 5vh;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          vertical-align: top;
        }

        button:hover {
          background-color: #45a049;
        }


        .container {
          width: 80vw;
          justify-content: center;
          align-items: center;
          margin: 20px auto;
        }

        #memo-list {
          width: 80vw;
          max-height: 70vh;
          overflow-y: auto;
          border: 1px solid #ccc;
          padding: 30px;
          background-color: lightgreen;
          border-radius: 8px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
          margin: 20px auto; 
          text-align: start;
        }

        .memo-item {
          font-size: 1rem; 
          margin-bottom: 15px;
          border-bottom: 1px solid #ddd;
          padding-bottom: 10px;
        }

        a {
          text-decoration: none;
          color : black;
          font-weight:bold
        }
  </style>
</head>

<body>
  <div id="root">
    <div id="head"><!-- Will dynamically add MenuItems here --></div>
    <div id="board"></div>
  </div>
  <script type="module">
    import {createElement, component, component2, render} from './index.js';
    import prompt from './prompt.js'
    
    // 현재 날짜와 시간을 나타내는 메서드 + 문자열로 변환
    const timestamp = new Date().toLocaleString();

    const root = document.getElementById('root');
    const head = document.getElementById('head');
    const board = document.getElementById('board');

  
    const headstateData = [
      { hash: '#home', text: 'Home', name: "Home" },
      { hash: '#team', text: 'Team', name: "Team" },
      { hash: '#member', text: 'Member', name: "Member" },
      { hash: '#purpose', text: 'Purpose', name: "Purpose" },
    ];
    const memberData = {
      "kim": {
        name: "김우진",
        url: "https://github.com/kimwoojin123/",
        hobby: ["음악감상", "자전거 타기"],
        resolution: "팀원들의 스트레스를 줄이겠습니다!"
      },
      "bang": {
        name: "방승희",
        url: "https://github.com/seunghee1108/",
        hobby: ["음악감상", "산책",],
        resolution: "빡세게 열심히 하겠습니다!"
      },
      "jung": {
        name: "정영식",
        url: "https://github.com/JungYoungSick",
        hobby: ["독서", "영화감상", "클래식감상", "자전거타기"],
        resolution: "맡은 바 최선을 다 하겠습니다!"
      },
      "choi": {
        name: "최성민",
        url: "https://github.com/csm009177",
        hobby: ["컴퓨터 하드웨어 조립"],
        resolution: "재밌게 같이 하겠습니다!"
      }
    };
    // append 
    const headvirtualDom = component(headstateData);
    const headcontainer = document.getElementById('head');
    headcontainer.appendChild(render(headvirtualDom));
    
    function mem(member){
      return component2("div", { id: `${memberData.member}`
      },[])
    }

    // #home prompt 
      // DOMContentLoaded : 돔이 다 만들어진 후에 이벤트가 발생하기 때문에 돔이 만들어지기 전에 자바스크립트 코드가 실행되는 오류를 방지
      document.addEventListener("DOMContentLoaded", () => {
        window.addEventListener("hashchange", ()=> {
      const selectors = {
        memoForm: document.getElementById('memo-Form'),
        title: document.getElementById('title'),
        content: document.getElementById('content'),
        saveBtn: document.getElementById('saveBtn'),
        memoList: document.getElementById('memo-list'),
      };


      if (!selectors.memoList) {
        console.error("Memo list element not found!");
        return; // memoList를 찾을 수 없는 경우 함수를 종료한다.
    }
      selectors.saveBtn.addEventListener('click', function (event) {
        // 이벤트의 기본 동작을 수행하지 않도록 막음
        event.preventDefault();
 
        const title = selectors.title.value;
        const content = selectors.content.value;

        // title, content 부분 입력이 되지 않았을 때 알림창 띄움
        if (!title) {
          alert('이름을 입력하세요.');
        } else if (!content) {
          alert('내용을 입력하세요.');
          return;
        }

        // 위 코드와 중복되어 주석처리 함(확인 후 삭제할것)
        // const timestamp = new Date().toLocaleString();

        // 새로운 메모 객체 생성
        const newMemo = {
          title: title,
          content: content,
          timestamp: timestamp
        };
        // JSON 저장 
        saveMemoToJson(newMemo);
        // creaetMemo : 새로운 메모 생성하고 화면에 표시
        createMemo(newMemo.title, newMemo.content, newMemo.timestamp);
        // 내용 부분만 초기화 (이름은 저장되어 있음)
        selectors.content.value = '';
      });

      // 메모 작성하면 저장되는 memo-item 동적으로 생성
      function createMemo(title, content, timestamp) {
        const memo = document.createElement('div');
        memo.classList.add('memo-item');
        const h2Tag = document.createElement('h2')
        h2Tag.innerHTML = title
        const PTag = document.createElement('p')
        PTag.innerHTML = content
        const P2Tag = document.createElement('p')
        P2Tag.innerHTML = timestamp
        memo.appendChild(h2Tag)
        memo.appendChild(PTag)
        memo.appendChild(P2Tag)

        selectors.memoList.appendChild(memo);
      }

      // 로컬 스토리지에서 이전에 저장된 메모 목록을 불러옴
      function saveMemoToJson(memo) {
        // / 이전에 저장된 메모가 없는 경우 빈 배열을 사용
        const memos = JSON.parse(localStorage.getItem('memos')) || [];
        // 새로 작성한 메모를 추가
        memos.push(memo);
        // 배열을 JSON 문자열로 변환하여 로컬 스토리지에 저장
        localStorage.setItem('memos', JSON.stringify(memos));
      }

      // 초기화 버튼
      const clearBtn = document.getElementById('clear');
      clearBtn.addEventListener('click', function() {
        localStorage.removeItem('memos'); // localStorage에서 'memos' 항목 제거
        selectors.memoList.innerHTML = ''; // memo-list 부분을 비움
      });

      // 로컬 스토리지에서 메모를 불러와 화면에 표시하는 함수
      function loadMemosFromLocalStorage() {
        // // 이전에 저장된 메모 목록을 불러오고, 없으면 빈 배열 생성
        const memos = JSON.parse(localStorage.getItem('memos')) || [];
        // selectors.memoList.innerHTML = '';
        //  배열 순회하면서 memo에 대해 createMemo 함수를 호출 
        memos.forEach((memo) => createMemo(memo.title, memo.content, memo.timestamp));
      }
      loadMemosFromLocalStorage();
      })
    });
    window.addEventListener('hashchange', () => { 
      // window.location 객체는 현재 url에 대한 정보를 제공한다
      const board = document.getElementById('board');  
      const hash = window.location.hash.substr(1);
      // #을 제외한 문자열을 반환하기 위해 substr(1)을 사용한다

      switch (hash) {
        
        case 'home' : 
          board.innerHTML = prompt
          break;
        case 'team' :
          board.innerHTML = 
          component2('div', { id:"cont", 
            style:'background-color:white;'}, 
            [component2('h1', {style : 'color:black; border-radius: 2vw; width:80vw; height:80vh; background-color: lightgreen; display:flex; justify-content:center; align-items: center'}, [`저희는 이제 DB, 데이터 베이스 구축을 진행 할 예정입니다.<br> 만드는 프로그램이 데이터 베이스를 
              꺼내는 역할을 해주기에 프로그램의 마음을 <br>이어받아 D를 꺼내줄지 B를 꺼내줄지 물어보는 것을 팀명으로 정했습니다.`])]);
          break;
        case 'member' :
          board.innerHTML = 
          component2('div', {style:"display:flex; flex-direction:row; width: 100vw; height: 90vh;"}, 
              [ 
              component2("div", { id:"side",
                style: ' display:flex; flex-direction:column; justifly-content:center; color:#ff2222; width: 25vw; height: 85vh; color: aliceblue;'},
                
                [
                component2('div', { style : "display:flex; justify-content:center; align-items: center; width:25vw; height:21vh;" }, 
                  [component2("a", {href:"#kim",  style:"width:10vw; height:10vh; background-color: #00cc33; display:flex; justify-content:center; align-items: center; border-radius: 2vw;"}, [`${Object.keys(memberData)[0]}`])]),
                component2('div', { style : "display:flex; justify-content:center; align-items: center;width:25vw; height:21vh " }, 
                  [component2("a", {href:"#bang", style:"width:10vw; height:10vh; background-color: #00cc33; display:flex; justify-content:center; align-items: center; border-radius: 2vw;"}, [`${Object.keys(memberData)[1]}`])]),
                component2('div', { style : "display:flex; justify-content:center; align-items: center;width:25vw; height:21vh " }, 
                  [component2("a", {href:"#jung", style:"width:10vw; height:10vh; background-color: #00cc33; display:flex; justify-content:center; align-items: center; border-radius: 2vw;"}, [`${Object.keys(memberData)[2]}`])]),
                component2('div', { style : "display:flex; justify-content:center; align-items: center;width:25vw; height:21vh " }, 
                  [component2("a", {href:"#choi", style:"width:10vw; height:10vh; background-color: #00cc33; display:flex; justify-content:center; align-items: center; border-radius: 2vw;"}, [`${Object.keys(memberData)[3]}`])]),
                ]),
              
              component2("div", { id:"boad",
                style: ' display:flex; align-items:center; justify-content:center; color:#ff2222; width: 75vw; height: 85vh; color: aliceblue;'}),
              ]
            )
          break;
        case 'purpose' :
          board.innerHTML = component2('div', { style: 'display:flex; justify-content:center; color:#333;'}, [component2('h1', {style : 'width:80vw; height:80vh; background-color: lightgreen; display:flex; justify-content:center; align-items: center; border-radius: 2vw;color:black'}, [`1. 후회가 남지 않도록 최선을 다하자.<br>
          2. 쉽게 오지 않는 기회를 잡고 나아가자. <br>
          3. 나의 것을 만들 때까지 포기하지 말자.`])])
            break;
        case 'kim' : 
        const kimboad = document.getElementById("boad")
        kimboad.innerHTML = 
          component2('div', { id:"cont1", 
            style: 'color:black; font-weight:bold '}, 
            [component2('p', {}, [`${memberData.kim.name}<br> Url : ${memberData.kim.url}<br> Hobby : ${memberData.kim.hobby}<br> Resolution : ${memberData.kim.resolution}`])])
          break;
        case 'bang' : 
        const bangboad = document.getElementById("boad")
        bangboad.innerHTML = 
          component2('div', { id:"cont2", 
            style: 'color:black; font-weight:bold '}, 
            [component2('p', {}, [`${memberData.bang.name}<br> Url : ${memberData.bang.url}<br> Hobby : ${memberData.bang.hobby}<br> Resolution : ${memberData.bang.resolution}`])])
          break;
        case 'jung' : 
        const jungboad = document.getElementById("boad")
        jungboad.innerHTML = 
          component2('div', { id:"cont3", 
            style: 'color:black; font-weight:bold '}, 
            [component2('p', {}, [`${memberData.jung.name}<br> Url : ${memberData.jung.url}<br> Hobby : ${memberData.jung.hobby}<br> Resolution : ${memberData.jung.resolution}`])])
          break;
        case 'choi' : 
        const choiboad = document.getElementById("boad")
        choiboad.innerHTML = 
          component2('div', { id:"cont4", 
            style: 'color:black;  font-weight:bold '}, 
            [component2('p', {}, [`${memberData.choi.name}<br> Url : ${memberData.choi.url}<br> Hobby : ${memberData.choi.hobby}<br> Resolution : ${memberData.choi.resolution}`])])
          break;
        default : 
        // 조건이 모두 다 부합하지 않을때, 즉 false 일때 default가 실행된다. 최초 접속에는 hash가 없기 때문에 default가 실행된다
          board.innerHTML = component2('h1', {style:"font-weight:bold "}, ["반갑습니다. 저희는 DyaBya 팀 입니다"]);
        }
      });
    // 초기 로딩을 위한 코드
    window.dispatchEvent(new Event('hashchange'));
    //dispatchEvent()는 지정된 이벤트를 생성하여, 이벤트를 발생시킨다
  </script>
</body>
</html>